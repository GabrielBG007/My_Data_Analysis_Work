legend.text= element_text(size=16),
axis.text.y=element_text(size=14),
axis.text.x=element_blank(),
legend.position="top",
legend.key.size= unit(2, "cm"),
legend.key.height = unit(0.3, "cm")) +
scale_y_continuous(limits=c(0,200))
title1 <- ggdraw() + draw_label("Días Normales", fontface="bold", size=18)
plot_grid(title1,p1,ncol=1,rel_heights=c(0.1,1))
p1 <- ggplot() +
theme_bw() +
geom_smooth(data=data5, aes(x=hour, y=ScatRed3000, colour="635 nm"), lwd=1, alpha=0.7, se=FALSE, span=0.2) +
geom_point(data=data5, aes(x=hour, y=ScatRed3000, fill="635 nm"), pch=21, colour="black", stroke=1, size=2) +
scale_colour_manual("", breaks= "635 nm", values= "red", guide=guide_legend(order=3)) +
scale_fill_manual("", breaks= "635 nm", values= "red", guide=guide_legend(order=3)) +
ggnewscale::new_scale_colour() +
ggnewscale::new_scale_fill() +
geom_line(data=data5, aes(x=hour, y=ScatGreen3000, colour="525 nm"), lwd=1, alpha=0.7) +
geom_point(data=data5, aes(x=hour, y=ScatGreen3000, fill="525 nm"),pch=21, colour="black", stroke=1, size=2) +
scale_colour_manual("", breaks= "525 nm", values= "green", guide=guide_legend(order=2)) +
scale_fill_manual("", breaks= "525 nm", values= "green", guide=guide_legend(order=2)) +
ggnewscale::new_scale_colour() +
ggnewscale::new_scale_fill() +
geom_line(data=data5, aes(x=hour, y=ScatBlue3000, colour="450 nm"), lwd=1, alpha=0.7) +
geom_point(data=data5, aes(x=hour, y=ScatBlue3000, fill="450 nm"),pch=21, colour="black", stroke=1, size=2) +
scale_colour_manual("", breaks= "450 nm", values= "blue", guide=guide_legend(order=1)) +
scale_fill_manual("", breaks= "450 nm", values= "blue", guide=guide_legend(order=1)) +
labs(x="Horas diarias", y=expression("Dispersión media Aurora 3000 (Mm"^-1*")"), title="Dispersión media diaria Aurora 3000 VS Horas") +
theme(plot.title= element_text(hjust=0.465, vjust=4, size=18)) +
scale_x_continuous("", breaks=c(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23)) +
theme(axis.title.y=element_text(size=16),
legend.text= element_text(size=16),
axis.text.y=element_text(size=14),
axis.text.x=element_blank(),
legend.position="top",
legend.key.size= unit(2, "cm"),
legend.key.height = unit(0.3, "cm")) +
scale_y_continuous(limits=c(0,200))
title1 <- ggdraw() + draw_label("Días Normales", fontface="bold", size=18)
plot_grid(title1,p1,ncol=1,rel_heights=c(0.1,1))
p1 <- ggplot() +
theme_bw() +
geom_smooth(data=data5, aes(x=hour, y=ScatRed3000, colour="635 nm"), lwd=1, alpha=0.7, se=FALSE, span=0.3) +
geom_point(data=data5, aes(x=hour, y=ScatRed3000, fill="635 nm"), pch=21, colour="black", stroke=1, size=2) +
scale_colour_manual("", breaks= "635 nm", values= "red", guide=guide_legend(order=3)) +
scale_fill_manual("", breaks= "635 nm", values= "red", guide=guide_legend(order=3)) +
ggnewscale::new_scale_colour() +
ggnewscale::new_scale_fill() +
geom_line(data=data5, aes(x=hour, y=ScatGreen3000, colour="525 nm"), lwd=1, alpha=0.7) +
geom_point(data=data5, aes(x=hour, y=ScatGreen3000, fill="525 nm"),pch=21, colour="black", stroke=1, size=2) +
scale_colour_manual("", breaks= "525 nm", values= "green", guide=guide_legend(order=2)) +
scale_fill_manual("", breaks= "525 nm", values= "green", guide=guide_legend(order=2)) +
ggnewscale::new_scale_colour() +
ggnewscale::new_scale_fill() +
geom_line(data=data5, aes(x=hour, y=ScatBlue3000, colour="450 nm"), lwd=1, alpha=0.7) +
geom_point(data=data5, aes(x=hour, y=ScatBlue3000, fill="450 nm"),pch=21, colour="black", stroke=1, size=2) +
scale_colour_manual("", breaks= "450 nm", values= "blue", guide=guide_legend(order=1)) +
scale_fill_manual("", breaks= "450 nm", values= "blue", guide=guide_legend(order=1)) +
labs(x="Horas diarias", y=expression("Dispersión media Aurora 3000 (Mm"^-1*")"), title="Dispersión media diaria Aurora 3000 VS Horas") +
theme(plot.title= element_text(hjust=0.465, vjust=4, size=18)) +
scale_x_continuous("", breaks=c(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23)) +
theme(axis.title.y=element_text(size=16),
legend.text= element_text(size=16),
axis.text.y=element_text(size=14),
axis.text.x=element_blank(),
legend.position="top",
legend.key.size= unit(2, "cm"),
legend.key.height = unit(0.3, "cm")) +
scale_y_continuous(limits=c(0,200))
title1 <- ggdraw() + draw_label("Días Normales", fontface="bold", size=18)
plot_grid(title1,p1,ncol=1,rel_heights=c(0.1,1))
p1 <- ggplot() +
theme_bw() +
geom_smooth(data=data5, aes(x=hour, y=ScatRed3000, colour="635 nm"), lwd=1, alpha=0.7, se=FALSE, span=0.2) +
geom_point(data=data5, aes(x=hour, y=ScatRed3000, fill="635 nm"), pch=21, colour="black", stroke=1, size=2) +
scale_colour_manual("", breaks= "635 nm", values= "red", guide=guide_legend(order=3)) +
scale_fill_manual("", breaks= "635 nm", values= "red", guide=guide_legend(order=3)) +
ggnewscale::new_scale_colour() +
ggnewscale::new_scale_fill() +
geom_smooth(data=data5, aes(x=hour, y=ScatGreen3000, colour="525 nm"), lwd=1, alpha=0.7, se=FALSE, span=0.2) +
geom_point(data=data5, aes(x=hour, y=ScatGreen3000, fill="525 nm"),pch=21, colour="black", stroke=1, size=2) +
scale_colour_manual("", breaks= "525 nm", values= "green", guide=guide_legend(order=2)) +
scale_fill_manual("", breaks= "525 nm", values= "green", guide=guide_legend(order=2)) +
ggnewscale::new_scale_colour() +
ggnewscale::new_scale_fill() +
geom_smooth(data=data5, aes(x=hour, y=ScatBlue3000, colour="450 nm"), lwd=1, alpha=0.7, se=FALSE, span=0.2) +
geom_point(data=data5, aes(x=hour, y=ScatBlue3000, fill="450 nm"),pch=21, colour="black", stroke=1, size=2) +
scale_colour_manual("", breaks= "450 nm", values= "blue", guide=guide_legend(order=1)) +
scale_fill_manual("", breaks= "450 nm", values= "blue", guide=guide_legend(order=1)) +
labs(x="Horas diarias", y=expression("Dispersión media Aurora 3000 (Mm"^-1*")"), title="Dispersión media diaria Aurora 3000 VS Horas") +
theme(plot.title= element_text(hjust=0.465, vjust=4, size=18)) +
scale_x_continuous("", breaks=c(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23)) +
theme(axis.title.y=element_text(size=16),
legend.text= element_text(size=16),
axis.text.y=element_text(size=14),
axis.text.x=element_blank(),
legend.position="top",
legend.key.size= unit(2, "cm"),
legend.key.height = unit(0.3, "cm")) +
scale_y_continuous(limits=c(0,200))
title1 <- ggdraw() + draw_label("Días Normales", fontface="bold", size=18)
plot_grid(title1,p1,ncol=1,rel_heights=c(0.1,1))
source("~/Universidad/Trabajo Fin De Grado/Programa R/Scat VS Horas_Diarias (7e-22f)/Scattering Horas diarias (Normales).R")
library(tidyverse)
library(datarium)
library(scales)
library(ggnewscale)
library(cowplot)
data1 <- Calibración
data2 <- data1 %>% na.omit()
data3 <- data2[9864:10137,]
data4 <- data3 %>% mutate(hour=hour(data3$date))
data5 <- data4 %>% group_by(hour) %>% summarise("ScatRed3000" = mean(ScatRed3000),
"ScatGreen3000" = mean(ScatGreen3000),
"ScatBlue3000" = mean(ScatBlue3000),
"ScatRed4000" = mean(ScatRed4000),
"ScatGreen4000" = mean(ScatGreen4000),
"ScatBlue4000" = mean(ScatBlue4000),
"Angstrom3000" = mean(Angstrom3000)) %>% print()
p2 <- ggplot() +
theme_bw() +
geom_smooth(data=data5, aes(x=hour, y=ScatRed3000, colour="635 nm"), lwd=1, alpha=0.7, se=FALSE, span=0.2) +
geom_point(data=data5, aes(x=hour, y=ScatRed3000, fill="635 nm"), pch=21, colour="black", stroke=1, size=2) +
scale_colour_manual("", breaks= "635 nm", values= "red", guide=guide_legend(order=3)) +
scale_fill_manual("", breaks= "635 nm", values= "red", guide=guide_legend(order=3)) +
ggnewscale::new_scale_colour() +
ggnewscale::new_scale_fill() +
geom_smooth(data=data5, aes(x=hour, y=ScatGreen3000, colour="525 nm"), lwd=1, alpha=0.7, se=FALSE, span=0.2) +
geom_point(data=data5, aes(x=hour, y=ScatGreen3000, fill="525 nm"),pch=21, colour="black", stroke=1, size=2) +
scale_colour_manual("", breaks= "525 nm", values= "green", guide=guide_legend(order=2)) +
scale_fill_manual("", breaks= "525 nm", values= "green", guide=guide_legend(order=2)) +
ggnewscale::new_scale_colour() +
ggnewscale::new_scale_fill() +
geom_smooth(data=data5, aes(x=hour, y=ScatBlue3000, colour="450 nm"), lwd=1, alpha=0.7, se=FALSE, span=0.2) +
geom_point(data=data5, aes(x=hour, y=ScatBlue3000, fill="450 nm"),pch=21, colour="black", stroke=1, size=2) +
scale_colour_manual("", breaks= "450 nm", values= "blue", guide=guide_legend(order=1)) +
scale_fill_manual("", breaks= "450 nm", values= "blue", guide=guide_legend(order=1)) +
labs(x="Horas diarias", y=expression("Dispersión media Aurora 3000 (Mm"^-1*")"), title="Dispersión media diaria Aurora 3000 VS Horas") +
theme(plot.title= element_text(hjust=0.465, size=18)) +
scale_x_continuous("", breaks=c(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23)) +
theme(axis.title.y=element_text(size=16),
axis.text.x=element_blank(),
legend.position="none")
title2 <- ggdraw() + draw_label("Días con intrusión de polvo", fontface="bold", size=18)
plot_grid(title2,p2,ncol=1,rel_heights=c(0.1,1))
p2 <- ggplot() +
theme_bw() +
geom_smooth(data=data5, aes(x=hour, y=ScatRed3000, colour="635 nm"), lwd=1, alpha=0.7, se=FALSE, span=0.2) +
geom_point(data=data5, aes(x=hour, y=ScatRed3000, fill="635 nm"), pch=21, colour="black", stroke=1, size=2) +
scale_colour_manual("", breaks= "635 nm", values= "red", guide=guide_legend(order=3)) +
scale_fill_manual("", breaks= "635 nm", values= "red", guide=guide_legend(order=3)) +
ggnewscale::new_scale_colour() +
ggnewscale::new_scale_fill() +
geom_smooth(data=data5, aes(x=hour, y=ScatGreen3000, colour="525 nm"), lwd=1, alpha=0.7, se=FALSE, span=0.2) +
geom_point(data=data5, aes(x=hour, y=ScatGreen3000, fill="525 nm"),pch=21, colour="black", stroke=1, size=2) +
scale_colour_manual("", breaks= "525 nm", values= "green", guide=guide_legend(order=2)) +
scale_fill_manual("", breaks= "525 nm", values= "green", guide=guide_legend(order=2)) +
ggnewscale::new_scale_colour() +
ggnewscale::new_scale_fill() +
geom_smooth(data=data5, aes(x=hour, y=ScatBlue3000, colour="450 nm"), lwd=1, alpha=0.7, se=FALSE, span=0.2) +
geom_point(data=data5, aes(x=hour, y=ScatBlue3000, fill="450 nm"),pch=21, colour="black", stroke=1, size=2) +
scale_colour_manual("", breaks= "450 nm", values= "blue", guide=guide_legend(order=1)) +
scale_fill_manual("", breaks= "450 nm", values= "blue", guide=guide_legend(order=1)) +
labs(x="Horas diarias", y=expression("Dispersión media Aurora 3000 (Mm"^-1*")"), title="Dispersión media diaria Aurora 3000 VS Horas") +
theme(plot.title= element_text(hjust=0.465, size=18)) +
scale_x_continuous("", breaks=c(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23)) +
theme(axis.title.y=element_text(size=16),
axis.text.x=element_blank(),
axis.text.y= element_text(size=14),
legend.position="none")
title2 <- ggdraw() + draw_label("Días con intrusión de polvo", fontface="bold", size=18)
plot_grid(title2,p2,ncol=1,rel_heights=c(0.1,1))
source("~/Universidad/Trabajo Fin De Grado/Programa R/Scat VS Horas_Diarias (7e-22f)/Scattering Horas diarias (Días con intrusión de polvo).R")
data1 <- Calibración
data2 <- data1 %>% na.omit()
data3 <- data2[c(1422:1661,4131:4239,5258:5582),] %>% print()
data4 <- data3 %>% mutate(hour=hour(data3$date))
data5 <- data4 %>% group_by(hour) %>% summarise("ScatRed3000" = mean(ScatRed3000),
"ScatGreen3000" = mean(ScatGreen3000),
"ScatBlue3000" = mean(ScatBlue3000),
"ScatRed4000" = mean(ScatRed4000),
"ScatGreen4000" = mean(ScatGreen4000),
"ScatBlue4000" = mean(ScatBlue4000),
"Angstrom3000"= mean(Angstrom3000)) %>% print()
p3 <- ggplot() +
theme_bw() +
geom_smooth(data=data5, aes(x=hour, y=ScatRed3000, colour="635 nm"), lwd=1, alpha=0.7, se=FALSE, span=0.2) +
geom_point(data=data5, aes(x=hour, y=ScatRed3000, fill="635 nm"), pch=21, colour="black", stroke=1, size=2) +
scale_colour_manual("", breaks= "635 nm", values= "red", guide=guide_legend(order=3)) +
scale_fill_manual("", breaks= "635 nm", values= "red", guide=guide_legend(order=3)) +
ggnewscale::new_scale_colour() +
ggnewscale::new_scale_fill() +
geom_smooth(data=data5, aes(x=hour, y=ScatGreen3000, colour="525 nm"), lwd=1, alpha=0.7, se=FALSE, span=0.2) +
geom_point(data=data5, aes(x=hour, y=ScatGreen3000, fill="525 nm"),pch=21, colour="black", stroke=1, size=2) +
scale_colour_manual("", breaks= "525 nm", values= "green", guide=guide_legend(order=2)) +
scale_fill_manual("", breaks= "525 nm", values= "green", guide=guide_legend(order=2)) +
ggnewscale::new_scale_colour() +
ggnewscale::new_scale_fill() +
geom_smooth(data=data5, aes(x=hour, y=ScatBlue3000, colour="450 nm"), lwd=1, alpha=0.7, se=FALSE, span=0.2) +
geom_point(data=data5, aes(x=hour, y=ScatBlue3000, fill="450 nm"),pch=21, colour="black", stroke=1, size=2) +
scale_colour_manual("", breaks= "450 nm", values= "blue", guide=guide_legend(order=1)) +
scale_fill_manual("", breaks= "450 nm", values= "blue", guide=guide_legend(order=1)) +
labs(x="Horas diarias", y=expression("Dispersión media Aurora 3000 (Mm"^-1*")"), title="Dispersión media diaria Aurora 3000 VS Horas") +
theme(plot.title= element_text(hjust=0.465, size=18)) +
scale_x_continuous("", breaks=c(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23)) +
theme(axis.title.y=element_text(size=16),
axis.text.y=element_text(size=14),
axis.text.x=element_text(size=14),
legend.position="none") +
scale_y_continuous(limits=c(0,200))
title3 <- ggdraw() + draw_label("Días con gran estabilidad atmosférica", fontface="bold", size=18)
plot_grid(title3,p3,ncol=1,rel_heights=c(0.1,1))
source("~/Universidad/Trabajo Fin De Grado/Programa R/Scat VS Horas_Diarias (7e-22f)/Scattering Horas diarias (Días con gran estabilidad atmosférica).R")
library(tidyverse)
library(datarium)
library(ggnewscale)
library(cowplot)
library(scales)
data1 <- left_join(PM10SU,PM1SU, by=c("date"="date"))
data2 <- data1 %>% select("date", "PM10"= "PM10S", "PM1")
data3 <- data2 %>% pivot_longer(c("PM10","PM1"), names_to="PM", values_to="PMV")
ggplot() +
theme_bw() +
geom_line(data=data3, aes(x=date, y=PMV, colour= PM), lty=1, alpha=0.6, lwd=1) +
geom_point(data=data3, aes(x=date, y=PMV, fill= PM),  alpha=0.6, pch=21, size=2.7, stroke=1) +
scale_fill_manual("", values=c("salmon2","brown")) +
scale_colour_manual("", values=c("salmon2","brown")) +
labs(title="PM VS DÍAS", x="", y=expression("PM"[10]*",PM"[1]*"(µg/m"^3*")")) +
theme(plot.title=element_text(hjust=0.5))
library(tidyverse)
library(datarium)
library(ggnewscale)
library(cowplot)
library(scales)
data1 <- left_join(PM10SU,PM1SU, by=c("date"="date"))
data2 <- data1 %>% select("date", "PM10"= "PM10S", "PM1")
data3 <- data2 %>% pivot_longer(c("PM10","PM1"), names_to="PM", values_to="PMV")
ggplot() +
theme_bw() +
geom_smooth(data=data3, aes(x=date, y=PMV, colour= PM), lty=1, alpha=0.6, lwd=1, se=FALSE, span=0.2) +
geom_point(data=data3, aes(x=date, y=PMV, fill= PM),  alpha=0.6, pch=21, size=2.7, stroke=1) +
scale_fill_manual("", values=c("salmon2","brown")) +
scale_colour_manual("", values=c("salmon2","brown")) +
labs(title="PM VS Días", x="", y=expression("PM"[10]*",PM"[1]*"(µg/m"^3*")")) +
theme(plot.title=element_text(hjust=0.5, size=18),
axis.title.y=element_text(size=16),
axis.text.y=element_text(size=14),
axis.text.x=element_text(size=14),
legend.text=element_text(size=16))
ggplot() +
theme_bw() +
geom_smooth(data=data3, aes(x=date, y=PMV, colour= PM), lty=1, alpha=0.6, lwd=1, se=FALSE, span=0.1) +
geom_point(data=data3, aes(x=date, y=PMV, fill= PM),  alpha=0.6, pch=21, size=2.7, stroke=1) +
scale_fill_manual("", values=c("salmon2","brown")) +
scale_colour_manual("", values=c("salmon2","brown")) +
labs(title="PM VS Días", x="", y=expression("PM"[10]*",PM"[1]*"(µg/m"^3*")")) +
theme(plot.title=element_text(hjust=0.5, size=18),
axis.title.y=element_text(size=16),
axis.text.y=element_text(size=14),
axis.text.x=element_text(size=14),
legend.text=element_text(size=16))
source("~/Universidad/Trabajo Fin De Grado/Programa R/PM VS DÍAS/PM VS DÍAS.R")
data1 <- Calibración
data2 <- data1 %>% na.omit()
data3 <- data2[-c(8191:10137,1:322,3188:3336,1422:1661,4131:4239,5258:5582,6445,6933),]
data4 <- data3 %>% mutate(hour=hour(data3$date))
data5 <- data4 %>% group_by(hour) %>% summarise("ScatRed3000" = mean(ScatRed3000),
"ScatGreen3000" = mean(ScatGreen3000),
"ScatBlue3000" = mean(ScatBlue3000),
"ScatRed4000" = mean(ScatRed4000),
"ScatGreen4000" = mean(ScatGreen4000),
"ScatBlue4000" = mean(ScatBlue4000),
"Angstrom3000"= mean(Angstrom3000)) %>% print()
p1 <- ggplot() +
theme_bw() +
geom_smooth(data=data5, aes(x=hour, y=ScatRed3000, colour="635 nm"), lwd=1, alpha=0.7, se=FALSE, span=0.2) +
geom_point(data=data5, aes(x=hour, y=ScatRed3000, fill="635 nm"), pch=21, colour="black", stroke=1, size=2) +
scale_colour_manual("", breaks= "635 nm", values= "red", guide=guide_legend(order=3)) +
scale_fill_manual("", breaks= "635 nm", values= "red", guide=guide_legend(order=3)) +
ggnewscale::new_scale_colour() +
ggnewscale::new_scale_fill() +
geom_smooth(data=data5, aes(x=hour, y=ScatGreen3000, colour="525 nm"), lwd=1, alpha=0.7, se=FALSE, span=0.2) +
geom_point(data=data5, aes(x=hour, y=ScatGreen3000, fill="525 nm"),pch=21, colour="black", stroke=1, size=2) +
scale_colour_manual("", breaks= "525 nm", values= "green", guide=guide_legend(order=2)) +
scale_fill_manual("", breaks= "525 nm", values= "green", guide=guide_legend(order=2)) +
ggnewscale::new_scale_colour() +
ggnewscale::new_scale_fill() +
geom_smooth(data=data5, aes(x=hour, y=ScatBlue3000, colour="450 nm"), lwd=1, alpha=0.7, se=FALSE, span=0.2) +
geom_point(data=data5, aes(x=hour, y=ScatBlue3000, fill="450 nm"),pch=21, colour="black", stroke=1, size=2) +
scale_colour_manual("", breaks= "450 nm", values= "blue", guide=guide_legend(order=1)) +
scale_fill_manual("", breaks= "450 nm", values= "blue", guide=guide_legend(order=1)) +
ggnewscale::new_scale_colour() +
ggnewscale::new_scale_fill() +
geom_smooth(data=data5, aes(x= hour, y=Angstrom3000*65, colour="SAE"), alpha=0.7, lty=5, lwd=1, se=FALSE, span=0.2) +
geom_point(data=data5, aes(x=hour, y= Angstrom3000*65, fill= "SAE"), pch=23, stroke=1, size=2, colour="black") +
scale_colour_manual("", breaks="SAE", values= "orange", guide= guide_legend(order=4)) +
scale_fill_manual("", breaks="SAE", values= "orange", guide=guide_legend(order=4)) +
labs(x="Horas diarias", y=expression("Dispersión media Aurora 3000 (Mm"^-1*")"), title="Dispersión media diaria Aurora 3000 y SAE (3000) VS Horas") +
theme(plot.title= element_text(hjust=0.465, vjust=4, size=18)) +
scale_x_continuous("", breaks=c(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23)) +
scale_y_continuous(name=expression("Dispersión media Aurora 3000 (Mm"^-1*")"),limits=c(0,200), sec.axis = sec_axis(trans~./65, name="SAE (3000)")) +
theme(axis.title.y=element_text(size=16),
axis.title.y.right= element_text(size=16),
axis.text.y=element_text(size=14),
axis.text.y.right=element_text(size=14),
legend.text=element_text(size=16),
axis.text.x=element_blank(),
legend.position="top",
legend.key.size= unit(2, "cm"),
legend.key.height= unit(0.3, "cm"))
title1 <- ggdraw() + draw_label("Días Normales", fontface="bold", size=18)
plot_grid(title1,p1,ncol=1,rel_heights=c(0.1,1))
source("~/Universidad/Trabajo Fin De Grado/Programa R/Dispersión,Angstrom/Scat_Angström_Diario_Normal.R")
data1 <- Calibración
data2 <- data1 %>% na.omit()
data3 <- data2[9864:10137,]
data4 <- data3 %>% mutate(hour=hour(data3$date))
data5 <- data4 %>% group_by(hour) %>% summarise("ScatRed3000" = mean(ScatRed3000),
"ScatGreen3000" = mean(ScatGreen3000),
"ScatBlue3000" = mean(ScatBlue3000),
"ScatRed4000" = mean(ScatRed4000),
"ScatGreen4000" = mean(ScatGreen4000),
"ScatBlue4000" = mean(ScatBlue4000),
"Angstrom3000" = mean(Angstrom3000)) %>% print()
p2 <- ggplot() +
theme_bw() +
geom_smooth(data=data5, aes(x=hour, y=ScatRed3000, colour="635 nm"), lwd=1, alpha=0.7, se=FALSE, span=0.2) +
geom_point(data=data5, aes(x=hour, y=ScatRed3000, fill="635 nm"), pch=21, colour="black", stroke=1, size=2) +
scale_colour_manual("", breaks= "635 nm", values= "red", guide=guide_legend(order=3)) +
scale_fill_manual("", breaks= "635 nm", values= "red", guide=guide_legend(order=3)) +
ggnewscale::new_scale_colour() +
ggnewscale::new_scale_fill() +
geom_smooth(data=data5, aes(x=hour, y=ScatGreen3000, colour="525 nm"), lwd=1, alpha=0.7, se=FALSE, span=0.2) +
geom_point(data=data5, aes(x=hour, y=ScatGreen3000, fill="525 nm"),pch=21, colour="black", stroke=1, size=2) +
scale_colour_manual("", breaks= "525 nm", values= "green", guide=guide_legend(order=2)) +
scale_fill_manual("", breaks= "525 nm", values= "green", guide=guide_legend(order=2)) +
ggnewscale::new_scale_colour() +
ggnewscale::new_scale_fill() +
geom_smooth(data=data5, aes(x=hour, y=ScatBlue3000, colour="450 nm"), lwd=1, alpha=0.7,se=FALSE, span=0.2) +
geom_point(data=data5, aes(x=hour, y=ScatBlue3000, fill="450 nm"),pch=21, colour="black", stroke=1, size=2) +
scale_colour_manual("", breaks= "450 nm", values= "blue", guide=guide_legend(order=1)) +
scale_fill_manual("", breaks= "450 nm", values= "blue", guide=guide_legend(order=1)) +
ggnewscale::new_scale_colour() +
ggnewscale::new_scale_fill() +
geom_smooth(data=data5, aes(x= hour, y=Angstrom3000*65, colour="SAE"), alpha=0.7, lty=5, lwd=1, se=FALSE, span=0.2) +
geom_point(data=data5, aes(x=hour, y= Angstrom3000*65, fill= "SAE"), pch=23, stroke=1, size=2, colour="black") +
scale_colour_manual("", breaks="SAE", values= "orange", guide= guide_legend(order=4)) +
scale_fill_manual("", breaks="SAE", values= "orange", guide=guide_legend(order=4)) +
labs(x="Horas diarias", y=expression("Dispersión media Aurora 3000 (Mm"^-1*")"), title="Dispersión media diaria Aurora 3000 y SAE (3000) VS Horas") +
theme(plot.title= element_text(hjust=0.465, size=18)) +
scale_x_continuous("", breaks=c(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23)) +
scale_y_continuous(name=expression("Dispersión media Aurora 3000 (Mm"^-1*")"), sec.axis = sec_axis(trans~./65, name="SAE (3000)")) +
theme(axis.title.y=element_text(size=16),
axis.title.y.right=element_text(size=16),
axis.text.y=element_text(size=14),
axis.text.y.right=element_text(size=14),
axis.text.x=element_blank(),
legend.position="none")
title2 <- ggdraw() + draw_label("Días con intrusión de polvo", fontface="bold", size=18)
plot_grid(title2,p2,ncol=1,rel_heights=c(0.1,1))
source("~/Universidad/Trabajo Fin De Grado/Programa R/Dispersión,Angstrom/Scat_Angström_Diario_Polvo.R")
data1 <- Calibración
data2 <- data1 %>% na.omit()
data3 <- data2[c(1422:1661,4131:4239,5258:5582),] %>% print()
data4 <- data3 %>% mutate(hour=hour(data3$date))
data5 <- data4 %>% group_by(hour) %>% summarise("ScatRed3000" = mean(ScatRed3000),
"ScatGreen3000" = mean(ScatGreen3000),
"ScatBlue3000" = mean(ScatBlue3000),
"ScatRed4000" = mean(ScatRed4000),
"ScatGreen4000" = mean(ScatGreen4000),
"ScatBlue4000" = mean(ScatBlue4000),
"Angstrom3000"= mean(Angstrom3000)) %>% print()
p3 <- ggplot() +
theme_bw() +
geom_smooth(data=data5, aes(x=hour, y=ScatRed3000, colour="635 nm"), lwd=1, alpha=0.7, se=FALSE, span=0.2) +
geom_point(data=data5, aes(x=hour, y=ScatRed3000, fill="635 nm"), pch=21, colour="black", stroke=1, size=2) +
scale_colour_manual("", breaks= "635 nm", values= "red", guide=guide_legend(order=3)) +
scale_fill_manual("", breaks= "635 nm", values= "red", guide=guide_legend(order=3)) +
ggnewscale::new_scale_colour() +
ggnewscale::new_scale_fill() +
geom_smooth(data=data5, aes(x=hour, y=ScatGreen3000, colour="525 nm"), lwd=1, alpha=0.7, se=FALSE, span=0.2) +
geom_point(data=data5, aes(x=hour, y=ScatGreen3000, fill="525 nm"),pch=21, colour="black", stroke=1, size=2) +
scale_colour_manual("", breaks= "525 nm", values= "green", guide=guide_legend(order=2)) +
scale_fill_manual("", breaks= "525 nm", values= "green", guide=guide_legend(order=2)) +
ggnewscale::new_scale_colour() +
ggnewscale::new_scale_fill() +
geom_smooth(data=data5, aes(x=hour, y=ScatBlue3000, colour="450 nm"), lwd=1, alpha=0.7, se=FALSE, span=0.2) +
geom_point(data=data5, aes(x=hour, y=ScatBlue3000, fill="450 nm"),pch=21, colour="black", stroke=1, size=2) +
scale_colour_manual("", breaks= "450 nm", values= "blue", guide=guide_legend(order=1)) +
scale_fill_manual("", breaks= "450 nm", values= "blue", guide=guide_legend(order=1)) +
ggnewscale::new_scale_colour() +
ggnewscale::new_scale_fill() +
geom_smooth(data=data5, aes(x= hour, y=Angstrom3000*65, colour="SAE"), alpha=0.7, lty=5, lwd=1, se=FALSE, span=0.2) +
geom_point(data=data5, aes(x=hour, y= Angstrom3000*65, fill= "SAE"), pch=23, stroke=1, size=2, colour="black") +
scale_colour_manual("", breaks="SAE", values= "orange", guide= guide_legend(order=4)) +
scale_fill_manual("", breaks="SAE", values= "orange", guide=guide_legend(order=4)) +
labs(x="Horas diarias", y=expression("Dispersión media Aurora 3000 (Mm"^-1*")"), title="Dispersión media diaria Aurora 3000 y SAE (3000) VS Horas") +
theme(plot.title= element_text(hjust=0.465, size=18)) +
scale_x_continuous("", breaks=c(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23)) +
scale_y_continuous(name=expression("Dispersión media Aurora 3000 (Mm"^-1*")"),limits=c(0,200), sec.axis = sec_axis(trans~./65, name="SAE (3000)")) +
theme(axis.title.y=element_text(size=16),
axis.title.y.right=element_text(size=16),
axis.text.y=element_text(size=14),
axis.text.y.right=element_text(size=14),
axis.text.x=element_text(size=14),
legend.position="none")
title3 <- ggdraw() + draw_label("Días con gran estabilidad atmosférica", fontface="bold", size=18)
plot_grid(title3,p3,ncol=1,rel_heights=c(0.1,1))
source("~/Universidad/Trabajo Fin De Grado/Programa R/Dispersión,Angstrom/Scat_Angström_Diario_Estabilidad.R")
library(readxl)
Calibración <- read_excel("~/Universidad/Trabajo Fin De Grado/Archivos Excel/Nuevos Excel Corregidos por días no válidos/7 enero-22 febrero/3000_4000 (7e-22f)_intervalo_día_promedio.xlsx")
View(Calibración)
library(readxl)
Division_PM <- read_excel("~/Universidad/Trabajo Fin De Grado/Archivos Excel/Nuevos Excel Corregidos por días no válidos/TODOS LOS PM/TODOS LOS PM.xlsx",
sheet = "PM10S I PM1S")
View(Division_PM)
library(tidyverse)
library(datarium)
library(scales)
library(ggnewscale)
library(cowplot)
library(RColorBrewer)
data1 <- left_join(Calibración,Division_PM, by=c("date"="date")) %>% drop_na()
data2 <- data1 %>% select(date,Angstrom3000,`PM10S/PM1S`)
data3 <- data2[-7,]
lmod1 <- lm(Angstrom3000~`PM10S/PM1S`, data= data3 )
summary(lmod1)
ggplot() +
theme_bw() +
geom_point(data=data3, aes(x= `PM10S/PM1S`, y= Angstrom3000, fill=Angstrom3000),pch=21, stroke=1, alpha=1, size=2.7) +
geom_smooth(data=data3, aes(x= `PM10S/PM1S`, y= Angstrom3000), method="lm", lty=5, alpha=0.6, colour="black", se=FALSE) +
scale_fill_gradientn("SAE",colors=c("darkblue","deepskyblue","yellow","green","chocolate2","red"), space="Lab") +
annotate("text", x=4.5, y=2.3, label="y= -0.3935x + 2.6593", colour="black") +
annotate("text", x=4.5, y=2.2, label=expression("R"^2*"=0.3552"), colour="black") +
labs(y="SAE(3000)", x=expression("PM"[10]*"/ PM"[1]*"(µg/m"^3*")"))
library(tidyverse)
library(datarium)
library(scales)
library(ggnewscale)
library(cowplot)
library(RColorBrewer)
data1 <- left_join(Calibración,Division_PM, by=c("date"="date")) %>% drop_na()
data2 <- data1 %>% select(date,Angstrom3000,`PM10S/PM1S`)
data3 <- data2[-7,]
lmod1 <- lm(Angstrom3000~`PM10S/PM1S`, data= data3 )
summary(lmod1)
ggplot() +
theme_bw() +
geom_point(data=data3, aes(x= `PM10S/PM1S`, y= Angstrom3000, fill=Angstrom3000),pch=21, stroke=1, alpha=1, size=2.7) +
geom_smooth(data=data3, aes(x= `PM10S/PM1S`, y= Angstrom3000), method="lm", lty=5, alpha=0.6, colour="black", se=FALSE) +
scale_fill_gradientn("SAE",colors=c("darkblue","deepskyblue","yellow","green","chocolate2","red"), space="Lab") +
annotate("text", x=4.5, y=2.3, label="y= -0.3935x + 2.6593", colour="black") +
annotate("text", x=4.5, y=2.2, label=expression("R"^2*"=0.3552"), colour="black") +
labs(y="SAE(3000)", x=expression("PM"[10]*"/ PM"[1]*"(µg/m"^3*")")) +
theme(axis.title.y=element_text(size=16),
axis.title.x=element_text(size=16),
axis.text.y=element_text(size=14),
axis.text.x=element_text(size=14),
legend.text=element_text(size=16))
ggplot() +
theme_bw() +
geom_point(data=data3, aes(x= `PM10S/PM1S`, y= Angstrom3000, fill=Angstrom3000),pch=21, stroke=1, alpha=1, size=2.7) +
geom_smooth(data=data3, aes(x= `PM10S/PM1S`, y= Angstrom3000), method="lm", lty=5, alpha=0.6, colour="black", se=FALSE) +
scale_fill_gradientn("SAE",colors=c("darkblue","deepskyblue","yellow","green","chocolate2","red"), space="Lab") +
annotate("text", x=4.5, y=2.3, label="y= -0.3935x + 2.6593", colour="black", size=10) +
annotate("text", x=4.5, y=2.2, label=expression("R"^2*"=0.3552"), colour="black", size=10) +
labs(y="SAE(3000)", x=expression("PM"[10]*"/ PM"[1]*"(µg/m"^3*")")) +
theme(axis.title.y=element_text(size=16),
axis.title.x=element_text(size=16),
axis.text.y=element_text(size=14),
axis.text.x=element_text(size=14),
legend.text=element_text(size=16))
ggplot() +
theme_bw() +
geom_point(data=data3, aes(x= `PM10S/PM1S`, y= Angstrom3000, fill=Angstrom3000),pch=21, stroke=1, alpha=1, size=2.7) +
geom_smooth(data=data3, aes(x= `PM10S/PM1S`, y= Angstrom3000), method="lm", lty=5, alpha=0.6, colour="black", se=FALSE) +
scale_fill_gradientn("SAE",colors=c("darkblue","deepskyblue","yellow","green","chocolate2","red"), space="Lab") +
annotate("text", x=4.5, y=2.3, label="y= -0.3935x + 2.6593", colour="black", size=4) +
annotate("text", x=4.5, y=2.2, label=expression("R"^2*"=0.3552"), colour="black", size=4) +
labs(y="SAE(3000)", x=expression("PM"[10]*"/ PM"[1]*"(µg/m"^3*")")) +
theme(axis.title.y=element_text(size=16),
axis.title.x=element_text(size=16),
axis.text.y=element_text(size=14),
axis.text.x=element_text(size=14),
legend.text=element_text(size=16))
ggplot() +
theme_bw() +
geom_point(data=data3, aes(x= `PM10S/PM1S`, y= Angstrom3000, fill=Angstrom3000),pch=21, stroke=1, alpha=1, size=2.7) +
geom_smooth(data=data3, aes(x= `PM10S/PM1S`, y= Angstrom3000), method="lm", lty=5, alpha=0.6, colour="black", se=FALSE) +
scale_fill_gradientn("SAE",colors=c("darkblue","deepskyblue","yellow","green","chocolate2","red"), space="Lab") +
annotate("text", x=4.5, y=2.3, label="y= -0.3935x + 2.6593", colour="black", size=6) +
annotate("text", x=4.5, y=2.2, label=expression("R"^2*"=0.3552"), colour="black", size=6) +
labs(y="SAE(3000)", x=expression("PM"[10]*"/ PM"[1]*"(µg/m"^3*")")) +
theme(axis.title.y=element_text(size=16),
axis.title.x=element_text(size=16),
axis.text.y=element_text(size=14),
axis.text.x=element_text(size=14),
legend.text=element_text(size=16))
ggplot() +
theme_bw() +
geom_point(data=data3, aes(x= `PM10S/PM1S`, y= Angstrom3000, fill=Angstrom3000),pch=21, stroke=1, alpha=1, size=2.7) +
geom_smooth(data=data3, aes(x= `PM10S/PM1S`, y= Angstrom3000), method="lm", lty=5, alpha=0.6, colour="black", se=FALSE) +
scale_fill_gradientn("SAE",colors=c("darkblue","deepskyblue","yellow","green","chocolate2","red"), space="Lab") +
annotate("text", x=4.5, y=2.3, label="y= -0.3935x + 2.6593", colour="black", size=5.8) +
annotate("text", x=4.5, y=2.2, label=expression("R"^2*"=0.3552"), colour="black", size=5.8) +
labs(y="SAE(3000)", x=expression("PM"[10]*"/ PM"[1]*"(µg/m"^3*")")) +
theme(axis.title.y=element_text(size=16),
axis.title.x=element_text(size=16),
axis.text.y=element_text(size=14),
axis.text.x=element_text(size=14),
legend.text=element_text(size=16))
source("~/Universidad/Trabajo Fin De Grado/Programa R/SAE VS PM/SAE VS PM.R")
